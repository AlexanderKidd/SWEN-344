<html>
    <head>
        <script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js" ></script>
        <meta name="google-signin-client_id" content="YOUR CLIENT ID HERE"></meta>
    </head>
    <body>

    <div id="gConnect">
        <h3>Oh no, you're not logged in!</h3>
        <div id="signin-button"></div>
    </div>

    <div id="authOps" style="display:none">
        <h3>Sign-in success</h3>

        <button id="signOut" onclick="auth2.signOut()">Sign Out</button>
        <div id="profile">
        </div>
    </div>

    <script type="application/javascript">
        var auth2 = {};
        var helper = (function() {
            return {
                /**
                 * Hides the sign in button and starts the post-authorization operations.
                 *
                 * @param {Object} authResult An Object which contains the access token and
                 *   other authentication information.
                 */
                onSignInCallback: function(authResult) {
                    var token = authResult.access_token;
                    console.log("TOKEN: " + token);
                    if (authResult.isSignedIn.get()) {
                        $('#authOps').show();
                        $('#gConnect').hide();
                        helper.profile();
                    }
                    else {
                        if (authResult['error'] || authResult.currentUser.get().getAuthResponse() == null) {
                            // There was an error, which means the user is not signed in.
                            // As an example, you can handle by writing to the console:
                            console.log('There was an error: ' + authResult['error']);
                        }
                        $('#authResult').append('Logged out');
                        $('#authOps').hide();
                        $('#gConnect').show();
                    }
                },

                /**
                 * Gets and renders the currently signed in user's profile data.
                 */
                profile: function(){
                    gapi.client.plus.people.get({
                        'userId': 'me'
                    }).then(function(res) {
                        var profile = res.result;
                        console.log(profile);
                        $('#profile').empty();
                        $('#profile').append(
                                $('<p><img src=\"' + profile.image.url + '\"></p>'));
                        $('#profile').append(
                                $('<p><em>Name: </em>' + profile.displayName + '<br /><em>Tagline: </em>' +
                                        profile.tagline + '</p>'));
                        if (profile.emails) {
                            $('#profile').append('<br/>Emails: ');
                            for (var i=0; i < profile.emails.length; i++){
                                $('#profile').append(profile.emails[i].value).append(' ');
                            }
                            $('#profile').append('<br/>');
                        }
                        if (profile.cover && profile.coverPhoto) {
                            $('#profile').append(
                                    $('<p><img src=\"' + profile.cover.coverPhoto.url + '\"></p>'));
                        }
                    }, function(err) {
                        var error = err.result;
                        $('#profile').empty();
                        $('#profile').append(error.message);
                    });
                }
            };
        })();

        /**
         * jQuery initialization
         */
        $(document).ready(function() {
            $('#loaderror').hide();
            if ($('meta')[0].content == 'YOUR CLIENT ID HERE') {
                alert('This sample requires your OAuth credentials (client ID) ' +
                        'from the Google APIs console:\n' +
                        '    https://code.google.com/apis/console/#:access\n\n' +
                        'Find and replace YOUR_CLIENT_ID with your client ID.'
                );
            }
        });

        /**
         * Handler for when the sign-in state changes.
         *
         * @param {boolean} isSignedIn The new signed in state.
         */
        var updateSignIn = function() {
            console.log('update sign in state');
            if (auth2.isSignedIn.get()) {
                helper.onSignInCallback(gapi.auth2.getAuthInstance());
            }
            else{
                helper.onSignInCallback(gapi.auth2.getAuthInstance());
            }
        };

        /**
         * This method sets up the sign-in listener after the client library loads.
         */
        function startApp() {
            gapi.load('auth2', function() {
                gapi.client.load('plus','v1').then(function() {
                    gapi.signin2.render('signin-button', {
                        scope: 'https://www.googleapis.com/auth/plus.login',
                        fetch_basic_profile: false });
                    gapi.auth2.init({fetch_basic_profile: false,
                        scope:'https://www.googleapis.com/auth/plus.login'}).then(
                            function (){
                                console.log('init');
                                auth2 = gapi.auth2.getAuthInstance();
                                auth2.isSignedIn.listen(updateSignIn);
                                auth2.then(updateSignIn);
                            });
                });
            });
        }
    </script>
    <script src="https://apis.google.com/js/client:platform.js?onload=startApp"></script>
</body>
</html>